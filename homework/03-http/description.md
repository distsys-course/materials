Ваши тесты никак не проверяют случай Get-запроса на директорию с хедером Accept-encoding.
Более того, если сделать сжатие листинга директории, тесты могут падать
В файле server.py приведено решение которое прошло все тесты успешно. 
Как видите, сжатие листинга директорий я вырезал (строка 137)
